version: "3.3"
services:
  mysqldb:
    image: "mysql:latest"
    environment:
      - MYSQL_ROOT_PASSWORD: root
    volumes:
      - dbachat:/var/lib/mysql
    # restart: always
    ports:
      - 3306:3306
    
  spring:
    build: "."
         context: .
         dockerfile: Dockerfile
         restart: on-failure
    ports:
      - 8089:8089
    depends_on:
      - mysqldb
    environment:
      SPRING_DATASOURCE_URL: jdbc:mysql://mysql-db:3306/achatdb?createDatabaseIfNotExist=true
      SPRING_DATASOURCE_USERNAME: root
      SPRING_DATASOURCE_PASSWORD: root
    volumes:
      - dbachat: